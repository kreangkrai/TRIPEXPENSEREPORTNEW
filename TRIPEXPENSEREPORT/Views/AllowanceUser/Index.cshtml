@model List<TRIPEXPENSEREPORT.Models.AllowanceModel>
@{
    ViewData["Title"] = "TE : เบิกเงิน";
}

<div class="container-fluid">
    <div class="row">
        <!-- Sidebar (ซ้าย) -->
        <div class="col-md-2 bg-light p-3 kanit-medium">
            <div class="card border-0 shadow-sm h-0 p-2 rounded-10">
                <h5 class="mb-3" style="padding:8px; color:white; border-radius:5px; background: #2178BE;
                    background: linear-gradient(90deg, rgba(33, 120, 190, 1) 0%, rgba(40, 71, 95, 1) 100%);">
                    ตัวกรอง
                </h5>
                <div class="mb-2">
                    <label for="date">วันที่เริ่มต้น:</label>
                    <input type="date" class="form-control" placeholder="วันที่ (dd/mm/yyyy)" />
                </div>

                <div class="mb-2">
                    <label for="date">วันที่สิ้นสุด:</label>
                    <input type="date" class="form-control" placeholder="วันที่ (dd/mm/yyyy)" />
                </div>

                <label for="date">ชื่อพนักงาน:</label>
                <select name="employees" id="employee" class="mb-3" style="border-radius:5px">
                    <option value="NULL">Please Select...</option>
                    <option value="EM001">Sarit T.</option>
                    <option value="EM002">Kriangkrai R.</option>
                    <option value="EM003">Jirawat J.</option>
                    <option value="EM004">Chakrit R.</option>
                </select>
                <button class="btn btn-primary w-100 mb-2" style="border-radius:8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">ค้นหา</button>
            </div>
        </div>

        <!-- Main Content (ขวา) -->
        <div class="col-md-10 p-3 kanit-regular">
            <h4 class="mb-3" style="color:#034694">เบี้ยเลี้ยง</h4>
            <div class="scrollable-table table-responsive-lg">
                <table class="table table-striped table-bordered ">
                    <thead class="bg-primary text-white align-content-center text-center">
                        <tr>
                            <th>วันที่</th>
                            <th>เวลา</th>
                            <th>ชื่อลูกค้า</th>
                            <th>จังหวัด</th>
                            <th>Job No.</th>
                            <th>ต่างจังหวัด</th>
                            <th>1-4 ชม.</th>
                            <th>4-8 ชม.</th>
                            <th>8 ชม.+</th>
                            <th>อื่นๆ</th>
                            <th>ค่าที่พัก</th>
                            <th>รายการ</th>
                            <th>จำนวนเงิน</th>
                            <th>รวม</th>
                            <th>หมายเหตุ</th>
                            <th>สถานะ</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model)
                        {
                            <tr data-date="@item.date.ToString("dd/MM/yyyy")"
                                data-time="@item.date_start.ToString("HH:mm")"
                                data-customer="@item.customer"
                                data-zipcode="@item.zipcode"
                                data-jobno="@item.job"
                                data-allowance-province="@item.allowance_province"
                                data-allowance-1-4="@item.allowance_1_4"
                                data-allowance-4-8="@item.allowance_4_8"
                                data-allowance-8="@item.allowance_8"
                                data-allowance-other="@item.allowance_other"
                                data-allowance-hostel="@item.allowance_hostel"
                                data-list="@item.list"
                                data-remark="@item.remark"
                                data-status="@item.status"
                                class="clickable-row align-content-center text-center">

                                <td>@item.date.ToString("dd/MM/yyyy")</td>
                                <td>@item.date_start.ToString("HH:mm")</td>
                                <td>@item.customer</td>
                                <td>@item.zipcode</td>
                                <td>@item.job</td>
                                <td>@item.allowance_province</td>
                                <td>@item.allowance_1_4</td>
                                <td>@item.allowance_4_8</td>
                                <td>@item.allowance_8</td>
                                <td>@item.allowance_other</td>
                                <td>@item.allowance_hostel</td>
                                <td>@item.list</td>
                                <td>150</td> <!-- ค่าคงที่ในตัวอย่าง -->
                                <td>300</td> <!-- ค่าคงที่ในตัวอย่าง -->
                                <td>@item.remark</td>
                                <td>@item.status</td>
                            </tr>
                        }
                    </tbody>
                </table>


                <div class="row kanit-medium d-flex justify-content-center g-0">
                    <div class="col-md-2 bg-light p-2">
                        <button class="btn btn-success w-100" data-toggle="modal" data-target="#sendModal"
                                style="border-radius:8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
                            Send & Export <i class="fas fa-download"></i>
                        </button>
                    </div>
                    <div class="col-md-2 bg-light p-2">
                        <button class="btn btn-danger w-100" data-toggle="modal" data-target="#cancelModal"
                                style="border-radius:8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
                            Cancel Send
                        </button>
                    </div>
                </div>

                <!-- Modal: Send -->
                <div class="modal fade" id="sendModal" tabindex="-1" role="dialog" aria-labelledby="sendModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="sendModalLabel">Confirm Send & Export</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                คุณต้องการส่งและส่งออกข้อมูล
                                <br /> ตั้งแต่วันที่ [dd/MM/yyyy] จนถึงวันที่ [dd/MM/yyyy] ใช่หรือไม่?
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" style="border-radius:8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);" data-dismiss="modal">
                                    ปิด</button>
                                <button type="button" class="btn btn-success" style="border-radius:8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
                                    ยืนยันการส่ง</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Modal: Cancel -->
                <div class="modal fade" id="cancelModal" tabindex="-1" role="dialog" aria-labelledby="cancelModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="cancelModalLabel">Cancel Send</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                คุณแน่ใจหรือไม่ว่าต้องการยกเลิกการส่ง?
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" style="border-radius:8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);" data-dismiss="modal">ปิด</button>
                                <button type="button" class="btn btn-danger" style="border-radius:8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">ยืนยันการยกเลิก</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal ที่ปรับแต่ง -->
<div class="modal fade" id="detailModal" tabindex="-1" role="dialog" aria-labelledby="detailModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-md" role="document">
        <!-- เพิ่ม modal-lg สำหรับขนาดใหญ่ -->
        <div class="modal-content">
            <div class="modal-header" style="background: linear-gradient(90deg, rgba(33, 120, 190, 1) 0%, rgba(40, 71, 95, 1) 100%); color: white; border-bottom: none;">
                <h5 class="modal-title kanit-regular" id="detailModalLabel">แก้ไขข้อมูล (เบี้ยเลี้ยง)</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true" style="color: white;">&times;</span>
                </button>
            </div>
            <div class="modal-body kanit-regular">
                <form>
                    <!-- ROW 1 : วันที่, Job -->
                    <div class="form-row ">
                        <fieldset disabled class="col-sm-12 col-md-6">
                            <div class="form-group">
                                <label for="disabledTextInputDate">วันที่</label>
                                <input type="text" class="form-control" id="disabledTextInputDate" placeholder="08/10/2025">
                            </div>
                        </fieldset>
                        <div class="form-group col-sm-12 col-md-6">
                            <label for="inputJob">Job</label>
                            <input type="text" class="form-control" id="inputJob" placeholder="Jxx-xxxx">
                        </div>

                    </div>

                    <!-- ROW 2 : ลูกค้า, จังหวัด -->
                    <div class="form-row">
                        <div class="form-group col-sm-12 col-md-8">
                            <label for="inputCustomer">ลูกค้า</label>
                            <input type="text" class="form-control" id="inputCustomer" placeholder="Ex. HOTEL, CTL-(HQ)">
                        </div>
                        <div class="form-group col-sm-12 col-md-4">
                            <label for="inputProvince">จังหวัด</label>
                            <input type="text" class="form-control" id="inputProvince" placeholder="Ex. กรุงเทพ">
                        </div>
                    </div>

                    <!-- ROW 3 : เบี้ยเลี้ยง -->
                    <label for="inputCustomer">เบี้ยเลี้ยง</label>
                    <div class="form-group ">
                        <div class="form-check form-check-inline col-sm-6 col-md-3 mb-1">
                            <input class="form-check-input " type="checkbox" id="inlineCheckboxAllowance_1_4" value="option1">
                            <label class="form-check-label" for="inlineCheckboxAllowance_1_4">1-4 ชม.</label>
                        </div>
                        <div class="form-check form-check-inline col-sm-6 col-md-3 mb-1">
                            <input class="form-check-input" type="checkbox" id="inlineCheckboxAllowance_4_8" value="option2">
                            <label class="form-check-label" for="inlineCheckboxAllowance_4_8">4-8 ชม.</label>
                        </div>
                        <div class="form-check form-check-inline col-sm-6 col-md-3 mb-1">
                            <input class="form-check-input" type="checkbox" id="inlineCheckboxAllowance_8_up" value="option3">
                            <label class="form-check-label" for="inlineCheckboxAllowance_8_up">8 ชม. ขึ้นไป</label>
                        </div>
                        <div class="form-check form-check-inline col-sm-6 col-md-3 mb-1">
                            <input class="form-check-input" type="checkbox" id="inlineCheckboxAllowance_province" value="option4">
                            <label class="form-check-label" for="inlineCheckboxAllowance_province">ต่างจังหวัด</label>
                        </div>
                        <div class="form-check form-check-inline col-sm-6 col-md-3 mb-1">
                            <input class="form-check-input" type="checkbox" id="inlineCheckboxAllowance_abroad" value="option5">
                            <label class="form-check-label" for="inlineCheckboxAllowance_abroad">ต่างประเทศ</label>
                        </div>
                        <div class="form-check form-check-inline col-sm-6 col-md-3 mb-1">
                            <input class="form-check-input" type="checkbox" id="inlineCheckboxAllowance_other" value="option6">
                            <label class="form-check-label" for="inlineCheckboxAllowance_other" style="margin-right:10px">อื่นๆ </label>
                            <input type="text" class="form-control col-sm-8 col-md-8" id="inputAllowance_other">
                        </div>
                    </div>

                    <!-- ROW 4 : ค่าที่พัก, ค่าใช้จ่ายอื่นๆ, รายการ -->
                    <div class="form-row ">
                        <div class="form-group col-sm-12 col-md-3">
                            <label for="inputJob">ค่าที่พัก</label>
                            <input type="text" class="form-control" id="inputJob" placeholder="0">
                        </div>
                        <div class="form-group col-sm-12 col-md-3">
                            <label for="inputJob">ค่าใช้จ่ายอื่นๆ</label>
                            <input type="text" class="form-control" id="inputJob" placeholder="0">
                        </div>
                        <div class="form-group col-sm-12 col-md-6">
                            <label for="inputJob">รายการ</label>
                            <input type="text" class="form-control" id="inputDescription" placeholder="Ex. เลี้ยงลูกค้า">
                        </div>

                    </div>

                    <!-- ROW 5 : หมายเหตุ, รวม -->
                    <div class="form-row">
                        <div class="form-group col-sm-12 col-md-8">
                            <label for="inputRemark">หมายเหตุ</label>
                            <input type="text" class="form-control" id="inputRemark">
                        </div>
                        <fieldset disabled class="col-sm-12 col-md-4">
                            <div class="form-group">
                                <label for="disabledTextInputAllowance_sum">รวม</label>
                                <input type="text" class="form-control" id="disabledTextInputAllowance_sum" placeholder="0">
                            </div>
                        </fieldset>
                    </div>

                    <!-- ROW 6 : อัปเดตล่าสุด, ผู้ดำเนินการ -->
                    <div class="form-row ">
                        <fieldset disabled class="col-sm-12 col-md-6">
                            <div class="form-group">
                                <label for="disabledTextInputDate">อัปเดตล่าสุด</label>
                                <input type="text" class="form-control" id="disabledTextInputDate" placeholder="08/10/2025 12:34:56">
                            </div>
                        </fieldset>
                        <fieldset disabled class="col-sm-12 col-md-6">
                            <div class="form-group">
                                <label for="disabledTextInputDate">ผู้ดำเนินการ</label>
                                <input type="text" class="form-control" id="disabledTextInputDate" placeholder="Kriangkrai R.">
                            </div>
                        </fieldset>
                    </div>
                </form>
            </div>
            <div class="modal-footer kanit-regular">
                <button type="button" class="btn btn-outline-danger col-sm-3 col-md-2" style="border-radius:8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);" data-dismiss="modal">ยกเลิก</button>
                <button type="button" class="btn btn-primary col-sm-3 col-md-3" style="border-radius:8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);" id="editButton">บันทึก</button>
            </div>
        </div>
    </div>
</div>


<!-- Modal : Send & Export -->
<div class="modal fade" id="detailModal" tabindex="-1" role="dialog" aria-labelledby="detailModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-md" role="document">
        <!-- เพิ่ม modal-lg สำหรับขนาดใหญ่ -->
        <div class="modal-content">
            <div class="modal-header" style="background: linear-gradient(90deg, rgba(33, 120, 190, 1) 0%, rgba(40, 71, 95, 1) 100%); color: white; border-bottom: none;">
                <h5 class="modal-title kanit-regular" id="detailModalLabel">แก้ไขข้อมูล (เบี้ยเลี้ยง)</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true" style="color: white;">&times;</span>
                </button>
            </div>
            <div class="modal-body kanit-regular">
                <form>
                    <!-- ROW 1 : วันที่, Job -->
                    <div class="form-row ">
                        <fieldset disabled class="col-sm-12 col-md-6">
                            <div class="form-group">
                                <label for="disabledTextInputDate">วันที่</label>
                                <input type="text" class="form-control" id="disabledTextInputDate" placeholder="08/10/2025">
                            </div>
                        </fieldset>
                        <div class="form-group col-sm-12 col-md-6">
                            <label for="inputJob">Job</label>
                            <input type="text" class="form-control" id="inputJob" placeholder="Jxx-xxxx">
                        </div>

                    </div>

                    <!-- ROW 2 : ลูกค้า, จังหวัด -->
                    <div class="form-row">
                        <div class="form-group col-sm-12 col-md-8">
                            <label for="inputCustomer">ลูกค้า</label>
                            <input type="text" class="form-control" id="inputCustomer" placeholder="Ex. HOTEL, CTL-(HQ)">
                        </div>
                        <div class="form-group col-sm-12 col-md-4">
                            <label for="inputProvince">จังหวัด</label>
                            <input type="text" class="form-control" id="inputProvince" placeholder="Ex. กรุงเทพ">
                        </div>
                    </div>

                    <!-- ROW 3 : เบี้ยเลี้ยง -->
                    <label for="inputCustomer">เบี้ยเลี้ยง</label>
                    <div class="form-group ">
                        <div class="form-check form-check-inline col-sm-6 col-md-3 mb-1">
                            <input class="form-check-input " type="checkbox" id="inlineCheckboxAllowance_1_4" value="option1">
                            <label class="form-check-label" for="inlineCheckboxAllowance_1_4">1-4 ชม.</label>
                        </div>
                        <div class="form-check form-check-inline col-sm-6 col-md-3 mb-1">
                            <input class="form-check-input" type="checkbox" id="inlineCheckboxAllowance_4_8" value="option2">
                            <label class="form-check-label" for="inlineCheckboxAllowance_4_8">4-8 ชม.</label>
                        </div>
                        <div class="form-check form-check-inline col-sm-6 col-md-3 mb-1">
                            <input class="form-check-input" type="checkbox" id="inlineCheckboxAllowance_8_up" value="option3">
                            <label class="form-check-label" for="inlineCheckboxAllowance_8_up">8 ชม. ขึ้นไป</label>
                        </div>
                        <div class="form-check form-check-inline col-sm-6 col-md-3 mb-1">
                            <input class="form-check-input" type="checkbox" id="inlineCheckboxAllowance_province" value="option4">
                            <label class="form-check-label" for="inlineCheckboxAllowance_province">ต่างจังหวัด</label>
                        </div>
                        <div class="form-check form-check-inline col-sm-6 col-md-3 mb-1">
                            <input class="form-check-input" type="checkbox" id="inlineCheckboxAllowance_abroad" value="option5">
                            <label class="form-check-label" for="inlineCheckboxAllowance_abroad">ต่างประเทศ</label>
                        </div>
                        <div class="form-check form-check-inline col-sm-6 col-md-3 mb-1">
                            <input class="form-check-input" type="checkbox" id="inlineCheckboxAllowance_other" value="option6">
                            <label class="form-check-label" for="inlineCheckboxAllowance_other" style="margin-right:10px">อื่นๆ </label>
                            <input type="text" class="form-control col-sm-8 col-md-8" id="inputAllowance_other">
                        </div>
                    </div>

                    
                </form>
            </div>
            <div class="modal-footer kanit-regular">
                <button type="button" class="btn btn-outline-danger col-sm-3 col-md-2" style="border-radius:8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);" data-dismiss="modal">ยกเลิก</button>
                <button type="button" class="btn btn-primary col-sm-3 col-md-3" style="border-radius:8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);" id="editButton">บันทึก</button>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function () {
            $(".clickable-row").click(function () {
                var date = $(this).data("date");
                var time = $(this).data("time");
                var customer = $(this).data("customer");
                var zipcode = $(this).data("zipcode");
                var jobNo = $(this).data("jobno");
                var allowanceProvince = $(this).data("allowance-province");
                var allowance1_4 = $(this).data("allowance-1-4");
                var allowance4_8 = $(this).data("allowance-4-8");
                var allowance8 = $(this).data("allowance-8");
                var allowanceOther = $(this).data("allowance-other");
                var allowanceHostel = $(this).data("allowance-hostel");
                var list = $(this).data("list");
                var description = $(this).data("description");
                var remark = $(this).data("remark");
                var status = $(this).data("status");

                $("#modalDate").text(date || "-");
                $("#modalTime").text(time || "-");
                $("#modalCustomer").text(customer || "-");
                $("#modalZipcode").text(zipcode || "-");
                $("#modalJobNo").text(jobNo || "-");
                $("#modalAllowanceProvince").text(allowanceProvince || "-");
                $("#modalAllowance1_4").text(allowance1_4 || "-");
                $("#modalAllowance4_8").text(allowance4_8 || "-");
                $("#modalAllowance8").text(allowance8 || "-");
                $("#modalAllowanceOther").text(allowanceOther || "-");
                $("#modalAllowanceHostel").text(allowanceHostel || "-");
                $("#modalList").text(list || "-");
                $("#modalDescription").text(description || "-");
                $("#modalRemark").text(remark || "-");
                $("#modalStatus").text(status || "-");

                $("#detailModal").modal("show");
            });

            // ปิด Modal
            $(".close, [data-dismiss='modal']").click(function () {
                $("#detailModal").modal("hide");
            });

            // ฟังก์ชันปุ่มใน Modal (ตัวอย่าง)
            $("#editButton").click(function () {
                alert("บันทึกข้อมูลสำเร็จ: " + $("#modalDate").text() + " เวลา " + $("#modalTime").text());
                // เพิ่มโค้ดสำหรับการแก้ไข (เช่น Redirect หรือ Form)
            });

            $("#deleteButton").click(function () {
                if (confirm("คุณแน่ใจหรือไม่ที่จะลบข้อมูลนี้?")) {
                    alert("ลบข้อมูล: " + $("#modalDate").text());
                    // เพิ่มโค้ดสำหรับการลบ (เช่น AJAX Call)
                    $("#detailModal").modal("hide");
                }
            });
        });
    </script>
}