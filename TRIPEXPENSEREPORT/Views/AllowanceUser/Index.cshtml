@model List<TRIPEXPENSEREPORT.Models.AllowanceModel>
@{
    ViewData["Title"] = "TE : เบิกเงิน";
}

<div class="container-fluid">
    <div class="row">
        <!-- Sidebar (ซ้าย) -->
        <div class="col-md-2 bg-light p-3 kanit-medium" >
            <div class="card border-0 shadow-sm h-0 p-2 rounded-10">
                <h5 class="mb-3" style="padding:8px; color:white; border-radius:5px; background: #2178BE;
                    background: linear-gradient(90deg, rgba(33, 120, 190, 1) 0%, rgba(40, 71, 95, 1) 100%);">
                    ตัวกรอง
                </h5>
                <div class="mb-2">
                    <input type="text" class="form-control" placeholder="วันที่ (dd/mm/yyyy)" />
                </div>
                <div class="mb-2">
                    <input type="text" class="form-control" placeholder="วันที่ (dd/mm/yyyy)" />
                </div>
                <button class="btn btn-primary w-100 mb-2" style="border-radius:8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">ค้นหา</button>
                <button class="btn btn-success w-100 mb-2" style="border-radius:8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">Send & Export <i class="fas fa-download"></i></button>
                <button class="btn btn-danger w-100" style="border-radius:8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">Cancel Send</button>
                <div class="input-group date" data-provide="datepicker">
                    <input type="text" class="form-control">
                    <div class="input-group-addon">
                        <span class="glyphicon glyphicon-th"></span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content (ขวา) -->
        <div class="col-md-10 p-3 kanit-regular">
            <h4 class="mb-3" style="color:#034694">เบี้ยเลี้ยง</h4>
            <div class="scrollable-table">
                <table class="table table-striped table-bordered">
                    <thead class="bg-primary text-white">
                        <tr>
                            <th>วันที่</th>
                            <th>เวลา</th>
                            <th>ชื่อลูกค้า</th>
                            <th>จังหวัด</th>
                            <th>Job No.</th>
                            <th>ต่างจังหวัด</th>
                            <th>1-4 ชม.</th>
                            <th>4-8 ชม.</th>
                            <th>8 ชม.+</th>
                            <th>อื่นๆ</th>
                            <th>ค่าที่พัก</th>
                            <th>รายการ</th>
                            <th>จำนวนเงิน</th>
                            <th>รายละเอียด</th>
                            <th>รวม</th>
                            <th>หมายเหตุ</th>
                            <th>สถานะ</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model)
                        {
                            <tr data-date="@item.date.ToString("dd/MM/yyyy")"
                                data-time="@item.date_start.ToString("HH:mm")"
                                data-customer="@item.customer" 
                                data-zipcode="@item.zipcode"
                                data-jobno="@item.job"
                                data-allowance-province="@item.allowance_province" 
                                data-allowance-1-4="@item.allowance_1_4"
                                data-allowance-4-8="@item.allowance_4_8"
                                data-allowance-8="@item.allowance_8" 
                                data-allowance-other="@item.allowance_other"
                                data-allowance-hostel="@item.allowance_hostel"
                                data-list="@item.list" 
                                data-description="@item.description"
                                data-remark="@item.remark"
                                data-status="@item.status"
                                class="clickable-row">

                                <td>@item.date.ToString("dd/MM/yyyy")</td>
                                <td>@item.date_start.ToString("HH:mm")</td>
                                <td>@item.customer</td>
                                <td>@item.zipcode</td>
                                <td>@item.job</td>
                                <td>@item.allowance_province</td>
                                <td>@item.allowance_1_4</td>
                                <td>@item.allowance_4_8</td>
                                <td>@item.allowance_8</td>
                                <td>@item.allowance_other</td>
                                <td>@item.allowance_hostel</td>
                                <td>@item.list</td>
                                <td>150</td> <!-- ค่าคงที่ในตัวอย่าง -->
                                <td>@item.description</td>
                                <td>300</td> <!-- ค่าคงที่ในตัวอย่าง -->
                                <td>@item.remark</td>
                                <td>@item.status</td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- Modal ที่ปรับแต่ง -->
<div class="modal fade" id="detailModal" tabindex="-1" role="dialog" aria-labelledby="detailModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <!-- เพิ่ม modal-lg สำหรับขนาดใหญ่ -->
        <div class="modal-content">
            <div class="modal-header" style="background: linear-gradient(90deg, rgba(33, 120, 190, 1) 0%, rgba(40, 71, 95, 1) 100%); color: white; border-bottom: none;">
                <h5 class="modal-title kanit-regular" id="detailModalLabel">แก้ไขข้อมูล (เบี้ยเลี้ยง)</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true" style="color: white;">&times;</span>
                </button>
            </div>
            <div class="modal-body kanit-regular">
                <div class="container-fluid ">
                    <!-- ROW1 : วันที่, Job, จังหวัด: -->
                    <div class="row">
                        <!-- วันที่ -->
                        <div class="col-12 col-sm-6 col-md-4 mb-2">
                            <div class="row align-items-center">
                                <div class="col-6 col-sm-6 col-md-4 text-right">
                                    <label class="mb-0" >วันที่:</label>
                                </div>
                                <div class="col-6 col-sm-6 col-md-8">
                                    <input type="text" class="form-control" id="recipient-name">
                                </div>
                            </div>
                        </div>
                        <!-- Job -->
                        <div class="col-12 col-sm-6 col-md-4 mb-2">
                            <div class="row align-items-center">
                                <div class="col-6 col-sm-6 col-md-4 text-right">
                                    <label class="mb-0">Job:</label>
                                </div>
                                <div class="col-6 col-sm-6 col-md-8">
                                    <input type="text" class="form-control" id="recipient-name">
                                </div>
                            </div>
                        </div>
                        <!-- จังหวัด -->
                        <div class="col-12 col-sm-6 col-md-4 mb-2">
                            <div class="row align-items-center">
                                <div class="col-6 col-sm-6 col-md-4 text-right">
                                    <label class="mb-0">จังหวัด:</label>
                                </div>
                                <div class="col-6 col-sm-6 col-md-8">
                                    <input type="text" class="form-control" id="recipient-name">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ROW2 : ชื่อลูกค้า -->
                    <div class="row">
                        <!-- ชื่อลูกค้า -->
                        <div class="col-12">
                            <div class="row align-items-center mb-5">
                                <div class="col-12 col-sm-6 col-md-2 text-right">
                                    <label class="mb-0">ชื่อลูกค้า:</label>
                                </div>
                                <div class="col-12 col-sm-6 col-md-10">
                                    <input type="text" class="form-control" id="recipient-name">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <!-- วันที่ -->
                    <div class="col-12 col-sm-6 col-md-6 mb-2">
                        <div class="row align-items-center">
                            <div class="col-6 col-sm-6 col-md-3 text-right">
                                <label class="mb-0">วันที่:</label>
                            </div>
                            <div class="col-6 col-sm-6 col-md-9">
                                <input type="text" class="form-control" id="recipient-name">
                            </div>
                        </div>
                    </div>
                    <!-- Job -->
                    <div class="col-12 col-sm-6 col-md-6 mb-2">
                        <div class="row align-items-center">
                            <div class="col-6 col-sm-6 col-md-3 text-right">
                                <label class="mb-0">Job:</label>
                            </div>
                            <div class="col-6 col-sm-6 col-md-9">
                                <input type="text" class="form-control" id="recipient-name">
                            </div>
                        </div>
                    </div>

                    <!-- จังหวัด -->
                    <div class="col-12 col-sm-6 col-md-6 mb-2">
                        <div class="row align-items-center">
                            <div class="col-6 col-sm-6 col-md-3 text-right">
                                <label class="mb-0">จังหวัด:</label>
                            </div>
                            <div class="col-6 col-sm-6 col-md-9">
                                <input type="text" class="form-control" id="recipient-name">
                            </div>
                        </div>
                    </div>
                    <!-- ชื่อลูกค้า -->
                    <div class="col-12 col-sm-6 col-md-6 mb-2">
                        <div class="row align-items-center">
                            <div class="col-6 col-sm-6 col-md-3 text-right">
                                <label class="mb-0">ชื่อลูกค้า:</label>
                            </div>
                            <div class="col-6 col-sm-6 col-md-9">
                                <input type="text" class="form-control" id="recipient-name">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="checkbox" id="inlineCheckbox1" value="option1">
                    <label class="form-check-label" for="inlineCheckbox1">1-4 ชม.</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="checkbox" id="inlineCheckbox2" value="option2">
                    <label class="form-check-label" for="inlineCheckbox2">4-8 ชม.</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="checkbox" id="inlineCheckbox3" value="option1">
                    <label class="form-check-label" for="inlineCheckbox1">8 ชม. ขึ้นไป</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="checkbox" id="inlineCheckbox4" value="option2">
                    <label class="form-check-label" for="inlineCheckbox2">ต่างจังหวัด</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="checkbox" id="inlineCheckbox5" value="option2">
                    <label class="form-check-label" for="inlineCheckbox2">ต่างประเทศ</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="checkbox" id="inlineCheckbox6" value="option2">
                    <label class="form-check-label" for="inlineCheckbox2">อื่น ๆ </label>
                </div>


                @* <div class="table-responsive">
                    <table class="table table-bordered">
                        <tbody>
                            <tr><th>วันที่</th><td><span id="modalDate"></span></td></tr>
                            <tr><th>เวลา</th><td><span id="modalTime"></span></td></tr>
                            <tr><th>ชื่อลูกค้า</th><td><span id="modalCustomer"></span></td></tr>
                            <tr><th>จังหวัด</th><td><span id="modalZipcode"></span></td></tr>
                            <tr><th>Job No.</th><td><span id="modalJobNo"></span></td></tr>
                            <tr><th>ต่างจังหวัด</th><td><span id="modalAllowanceProvince"></span></td></tr>
                            <tr><th>1-4 ชม.</th><td><span id="modalAllowance1_4"></span></td></tr>
                            <tr><th>4-8 ชม.</th><td><span id="modalAllowance4_8"></span></td></tr>
                            <tr><th>8 ชม.+</th><td><span id="modalAllowance8"></span></td></tr>
                            <tr><th>อื่นๆ</th><td><span id="modalAllowanceOther"></span></td></tr>
                            <tr><th>ค่าที่พัก</th><td><span id="modalAllowanceHostel"></span></td></tr>
                            <tr><th>รายการ</th><td><span id="modalList"></span></td></tr>
                            <tr><th>จำนวนเงิน</th><td><span id="modalAmount">150</span></td></tr>
                            <tr><th>รายละเอียด</th><td><span id="modalDescription"></span></td></tr>
                            <tr><th>รวม</th><td><span id="modalTotal">300</span></td></tr>
                            <tr><th>หมายเหตุ</th><td><span id="modalRemark"></span></td></tr>
                            <tr><th>สถานะ</th><td><span id="modalStatus"></span></td></tr>
                        </tbody>
                    </table>
                </div> *@
            </div>
            <div class="modal-footer kanit-regular">
                <button type="button" class="btn btn-outline-success" id="editButton">บันทึก</button>
                <button type="button" class="btn btn-close" data-dismiss="modal">ยกเลิก</button>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function () {
            $(".clickable-row").click(function () {
                var date = $(this).data("date");
                var time = $(this).data("time");
                var customer = $(this).data("customer");
                var zipcode = $(this).data("zipcode");
                var jobNo = $(this).data("jobno");
                var allowanceProvince = $(this).data("allowance-province");
                var allowance1_4 = $(this).data("allowance-1-4");
                var allowance4_8 = $(this).data("allowance-4-8");
                var allowance8 = $(this).data("allowance-8");
                var allowanceOther = $(this).data("allowance-other");
                var allowanceHostel = $(this).data("allowance-hostel");
                var list = $(this).data("list");
                var description = $(this).data("description");
                var remark = $(this).data("remark");
                var status = $(this).data("status");

                $("#modalDate").text(date || "-");
                $("#modalTime").text(time || "-");
                $("#modalCustomer").text(customer || "-");
                $("#modalZipcode").text(zipcode || "-");
                $("#modalJobNo").text(jobNo || "-");
                $("#modalAllowanceProvince").text(allowanceProvince || "-");
                $("#modalAllowance1_4").text(allowance1_4 || "-");
                $("#modalAllowance4_8").text(allowance4_8 || "-");
                $("#modalAllowance8").text(allowance8 || "-");
                $("#modalAllowanceOther").text(allowanceOther || "-");
                $("#modalAllowanceHostel").text(allowanceHostel || "-");
                $("#modalList").text(list || "-");
                $("#modalDescription").text(description || "-");
                $("#modalRemark").text(remark || "-");
                $("#modalStatus").text(status || "-");

                $("#detailModal").modal("show");
            });

            // ปิด Modal
            $(".close, [data-dismiss='modal']").click(function () {
                $("#detailModal").modal("hide");
            });

            // ฟังก์ชันปุ่มใน Modal (ตัวอย่าง)
            $("#editButton").click(function () {
                alert("บันทึกข้อมูลสำเร็จ: " + $("#modalDate").text() + " เวลา " + $("#modalTime").text());
                // เพิ่มโค้ดสำหรับการแก้ไข (เช่น Redirect หรือ Form)
            });

            $("#deleteButton").click(function () {
                if (confirm("คุณแน่ใจหรือไม่ที่จะลบข้อมูลนี้?")) {
                    alert("ลบข้อมูล: " + $("#modalDate").text());
                    // เพิ่มโค้ดสำหรับการลบ (เช่น AJAX Call)
                    $("#detailModal").modal("hide");
                }
            });
        });
    </script>
}