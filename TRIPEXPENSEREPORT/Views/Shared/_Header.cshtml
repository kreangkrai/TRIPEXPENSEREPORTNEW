@using Microsoft.AspNetCore.Http
@{
    var userid = Context.Session.GetString("userId");
    //List<RoleModel> roles = ViewBag.Roles;
}
<nav class="main-header navbar navbar-expand navbar-light" style=" background: #034694;
     background: linear-gradient(90deg, rgba(3, 70, 148, 1) 00%, rgba(33, 114, 181, 1) 100%);">

    <!-- LOGO TE REPORT-->
    <ul class="navbar-nav">
        <li class="nav-item">
            <a class="nav-link" asp-controller="Home" asp-action="Index">
                <img src="~/images/logo_tereport_bbg.png" style="width:fit-content; height:30px; " />
            </a>
        </li>
    </ul>

    <!-- NAVBAR TOP-->
    <ul class="navbar-nav">
        @{
            <li class="nav-item d-flex align-items-center">
                @{
                    if (@userid == "admin")
                    {
                        <a style="background-color:#0F4C75;width:20px" asp-controller="Monitor" asp-action="Index"><i class="fas fa-desktop"></i></a>
                    }
                }
            </li>

            <li class="nav-item">
                <div class="dropdown show">
                    <a class="btn dropdown-toggle" style="color:white" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        For User
                    </a>
                    <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                        <a class="dropdown-item" asp-controller="User" asp-action="Index"><i class="fa-solid fa-car-side"></i> รถส่วนตัว</a>
                        <a class="dropdown-item" asp-controller="Monitor" asp-action="Index"><i class="fa-solid fa-truck-pickup"></i> รถบริษัท</a>
                        <a class="dropdown-item" asp-controller="Device" asp-action="Index"><i class="fa-solid fa-file-invoice-dollar"></i>  เบี้ยเลี้ยง</a>
                    </div>
                </div>
            </li>

            //RoleModel role = roles.Where(w => w.user == userid).FirstOrDefault();
            List<string> managements = new List<string>() { "User" };
            //if (@managements.Count > 0)
            //{
            <li class="nav-item">
                <div class="dropdown show">
                    <a class="btn dropdown-toggle" style="color:white" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        For Admin
                    </a>
                    <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                        @if (@managements.Any(a => a == "User"))
                        {
                            <a class="dropdown-item" asp-controller="User" asp-action="Index"><i class="fas fa-user"></i> รถส่วนตัว</a>
                        }
                        @if (@managements.Any(a => a == "Monitor"))
                        {
                            <a class="dropdown-item" asp-controller="Monitor" asp-action="Index"><i class="fas fa-desktop"></i> รถบริษัท</a>
                        }
                        @if (@managements.Any(a => a == "Device"))
                        {
                            <a class="dropdown-item" asp-controller="Device" asp-action="Index"><i class="fas fa-cog"></i> เบี้ยเลี้ยง</a>
                        }
                    </div>
                </div>
            </li>

            <li class="nav-item">
                <div class="dropdown show">
                    <a class="btn dropdown-toggle" style="color:white" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Summary Company Car
                    </a>
                    <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                        <a class="dropdown-item" asp-controller="User" asp-action="Index"><i class="fa-solid fa-car-side"></i> รถส่วนตัว</a>
                        <a class="dropdown-item" asp-controller="Monitor" asp-action="Index"><i class="fa-solid fa-truck-pickup"></i> รถบริษัท</a>
                        <a class="dropdown-item" asp-controller="Device" asp-action="Index"><i class="fa-solid fa-file-invoice-dollar"></i>  เบี้ยเลี้ยง</a>
                    </div>
                </div>
            </li>

            <li class="nav-item">
                <div class="dropdown show">
                    <a class="btn dropdown-toggle" style="color:white" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Setting
                    </a>
                    <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                        <a class="dropdown-item" asp-controller="User" asp-action="Index"><i class="fa-solid fa-car-side"></i> รถส่วนตัว</a>
                        <a class="dropdown-item" asp-controller="Monitor" asp-action="Index"><i class="fa-solid fa-truck-pickup"></i> รถบริษัท</a>
                        <a class="dropdown-item" asp-controller="Device" asp-action="Index"><i class="fa-solid fa-file-invoice-dollar"></i>  เบี้ยเลี้ยง</a>
                    </div>
                </div>
            </li>

            <li class="nav-item">
                <div class="dropdown show">
                    <a class="btn dropdown-toggle" style="color:white" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Management
                    </a>
                    <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                        <a class="dropdown-item" asp-controller="User" asp-action="Index"><i class="fa-solid fa-car-side"></i> รถส่วนตัว</a>
                        <a class="dropdown-item" asp-controller="Monitor" asp-action="Index"><i class="fa-solid fa-truck-pickup"></i> รถบริษัท</a>
                        <a class="dropdown-item" asp-controller="Device" asp-action="Index"><i class="fa-solid fa-file-invoice-dollar"></i>  เบี้ยเลี้ยง</a>
                    </div>
                </div>
            </li>
        }
    </ul>

    <!-- User Info -->
    <ul class="nav navbar-nav ml-auto">
        <!-- User Account Menu -->
        <li class="dropdown user user-menu">
            <!-- Menu Toggle Button -->
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                <!-- The user image in the navbar-->
                @{
                    byte[] image = Context.Session.Get("Image");
                    var base64 = Convert.ToBase64String(image);
                    var imgSrc = String.Format("data:image/gif;base64,{0}", base64);
                    if (@imgSrc != null)
                    {
                        // <img src="~/images/user.png" class="user-image" alt="User Image">
                        <img src="@imgSrc" class="user-image" alt="User Image">
                    }
                }
            </a>
            <ul class="dropdown-menu">
                <li class="user-header" style="background: #2178BE;
                background: linear-gradient(180deg, rgba(33, 120, 190, 1) 0%, rgba(21, 52, 88, 1) 100%);color:white">
                    @{
                        if (imgSrc != null)
                        {
                            <img src="@imgSrc" class="img-circle" alt="User Image">
                        }
                    }
                    
                    <div class="pull-left">
                        <p>
                            @userid
                        </p>
                        <a class="btn btn-secondary" style="color:white; background-color:#D04B4D; width:100px; height:40px" asp-area="" asp-controller="Account" asp-action="Logout">Log Out</a>
                    </div>
                </li>
                
            </ul>
        </li>
    </ul>
</nav>